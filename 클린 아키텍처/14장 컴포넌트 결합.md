# 14장 컴포넌트 결합

이 장에서 다룰 세 가지 원칙은 컴포넌트 사이의 관계를 설명한다.

### ADP: 의존성 비순환 원칙
컴포넌트 의존성 그래프에 순환(사이클)이 있으면 안된다.  
소스 코드를 수정하고 배포하면 갑자기 안되는 경우가 많다. 이를 해결하기 위해선 순환 의존성 제거하기를 할 수 있다.  

이 문제의 해결책은 개발 환경을 릴리스 가능한 컴포넌트 단위로 분리하는 것이다.  
컴포넌트는 개별 개발자 또는 단일 개발팀이 책임질 수 있는 작업 단위가 된다.  
따라서 어떤 컴포넌트도 다른 컴포넌트에 의해 좌우되지 않는다.  
이 절차를 성공적으로 하려면 의존성을 확실하게 관리해야 한다. 또한 어떤 컴포넌트에서 시작하더라도 다시 최초의
컴포넌트로는 돌아갈 수 없다는 점이다.  

#### 순환 끊기 
의존성 역전 원칙 적용: 의존성 역전 원칙으로 사이클을 끊을 수 있다.

### 어쩔 수 없는 하향식 설계
컴포넌트 구조는 하향식으로 설계될 수 밖에 없다. 컴포넌트는 시스템에서 가장 먼저 설계할 대상이 아니고, 시스템이
성장하고 변경될때 함께 진화하는 성격을 지닌다.  

컴포넌트 의존성 다이어그램은 애플리케이션의 빌드 가능성과 유지보수성을 보여주는 지도와 같다.  
의존성 구조와 관련된 최우선 관심사는 변동성을 격리하는 일이다.  
따라서 컴포넌트 의존성 그래프는 안정적이며 가치가 높은 컴포넌트를 보호하려는 아키텍처를 만들고 가다듬게 된다.  

**결론: 컴포넌트 의존성 그래프를 작성하고 관리하라.**

### SDP: 안정된 의존성 원칙
안정성의 방향에 의존하라.

설계는 정적일 수 없다. 변경은 불가피하다. 따라서 변경이 어려운 컴포넌트가 변동이 예상되는 컴포넌트에 의존하게
만들어서는 절대로 안된다. 한 번 의존하기 시작하면 변동성이 큰 컴포넌트도 결국 변경이 어려워진다.  

#### 안정성 지표
안정성 지표는 컴포넌트로 들어오고 나가는 의존성 개수를 세어 보는 방법이 있다.
* Fan-In: 안으로 들어오는 의존성. 컴포넌트 내부 클래스에 의존하는 외부 클래스의 개수를 나타낸다.
* Fan-Out: 바깥으로 나가는 의존성. 컴포넌트 외부의 클래스에 의존하는 컴포넌트 내부의 클래스 개수를 나타낸다.
* I(불안정성): I = Fan-Out % (Fan-In + Fan-Out) <- 이 지표는 [0,1] 범위 값을 가진다. 
  I가 0에 가까울수록 안정된 컴포넌트이다.

### SAP: 안정된 추상화 원칙
컴포넌트는 안정된 정도만큼만 추상화되어야 한다.

**고수준 정책을 어디에 위치시켜야 하는가?**
고수준 정책을 안정된 컴포넌트에 위치시키면, 그 정책을 포함하는 소스 코드는 수정하기가 어려워진다.  
컴포넌트가 안정된 상태이면서도, 변경에 대응할 수 있게 유연한 방법은 무엇인가?
정답은 개방 폐쇄 원칙(OCP)에서 찾을 수 있다.

