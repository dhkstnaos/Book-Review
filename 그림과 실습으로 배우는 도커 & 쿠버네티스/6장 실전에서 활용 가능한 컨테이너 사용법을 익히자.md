# 6장 실전에서 활용 가능한 컨테이너 사용법을 익히자

## 컨테이너와 호스트 간에 파일 복사하기
```java
파일 복사 커맨드
    
호스트에서 컨테이너로 복사하는 커맨드     
docker cp 호스트_경로 컨테이너_이름:컨테이너_경로

컨테이너에서 호스트로 복사하는 커맨드
docker cp 컨테이너_이름:컨테이너_경로 호스트_경로
```
### 볼륨 마운트
볼륨이란 스토리지의 한 영역을 분할한 것이다. 마운트를 연결하다라는 뜻으로 대상을 연결에 운영체제 또는
소프트웨어의 관리하에 두는 일을 말한다.  
컨테이너가 종료되어도 바로 삭제되지는 않지만 특성상 언젠가는 삭제된다. 따라서 데이터 영속성을 지키기 위해 마운트를
하는 것이다.  

### 스토리지 마운트의 종류 2가지
하나는 볼륨 마운트, 다른 하나는 바인드 마운트이다.

#### 볼륨 마운트
볼륨 마운트는 도커 엔진이 관리하는 영역 내에 만들어진 볼륨을 컨테이너에 디스크 형태로 마운트한다. 다루기 쉬우나
직접 조작하기 어려워 임시로 사용할때 사용한다.  

#### 바인드 마운트
바인드 마운트는 도커가 설치된 컴퓨터의 문서 폴더 등 도커 엔진에서 관리하지 않는 영역에서 마운트를 하는 방식이다.  
폴더를 열어볼 수 있기에 자주 사용하는 파일을 두는데 사용한다.  

### 스토리지 마운트의 커맨드
먼저 마운트될 스토리지를 생성해야 한다.  
````java
볼륨 생성
docker volume create 볼륨_이름

볼륨 삭제    
docker volume rm 볼륨_이름

볼륨 정보 출력
docker inspect rm 볼륨_이름

볼륨 목록 출력
docker ls
````

#### 스토리지 마운트 커맨드
```java
볼륨 마운트 커맨드
docker run -v 볼륨_이름:컨테이너_마운트_경로

바인드 마운트 커맨드
docker run - v 스토리지_실제_경로:컨테이너_마운트_경로
```

## 컨테이너로 이미지 만들기
도커 이미지를 만드는 방법은 두 가지가 있다.
1. commit 커맨드로 기존 컨테이너를 이미지로 변환하는 방법
2. Dockerfile 스크립트로 이미지를 만드는 방법 - dockerfile은 이미지를 만드는 역할을 한다.

1번 방법 예시
```java
docker commit 컨테이너_이름 새_이미지_이름
```

2번 방법 예시
```java
docker build -t 생성할_이미지_이름 재료_폴더_경로

docker 스크립트 예
FROM 이미지_이름
COPY 원본_경로 대상_경로
RUN 리눅스_명령어
```
DockerFile의 인스트럭션
```java
FROM 토대가 되는 이미지 지정
ADD 이미지에 파일이나 폴더 추가
COPY 이미지에 파일이나 폴더 추가
RUN 이미지를 빌드할때 실행할 명령어 지정
CMD 컨테이너를 실행할때 실행할 명령어 지정
```

## 컨테이너 개조
컨테이너를 수정해야 할 일이 종종 있다. 그럴때 사용한다.  
두 가지 방법이 있고, 혼용해 사용한다.
1. 파일 복사
2. 리눅스 명령어 실행

#### 컨테이너에서 명령어를 실행하면 셀이 필요하다.
컨테이너에서 리눅스 명령어를 실행하려면 리눅스에게 명령을 전달해주는 셀이 필요하다.  
셸에도 종류가 있는데 거의 bash를 사용한다.  

bash를 실행하려면 다음 인자를 전달하면 된다.  
보통 docker exec와 함께 사용한다.  
docker exec는 컨테이너 속에서 명령어를 실행하는 커맨드이다. 실행 중인 컨테이너에 Run을 사용할 수 없으니 이 것을 사용한다.
```java
/bin/bash

exec 커맨드에 인자를 추가한 예
docker exec (옵션) 컨테이너_이름 /bin/bash
```
bash 명령은 도커 엔진에 하는 명령과 다르게 컨테이너 내부의 명령을 조작하는 것이다.  

## 도커 허브 등록 및 로그인
직접 만든 이미지를 도커 허브에 올릴수도 있고, 내려받을수도 있다.  
도커에 이미지를 업로드 하려면 태그를 입력해야 한다. 레지스트리 주소와 버전 표기를 통해 정식 명칭으로 만든다.  
태그는 '레디스트리_주소(도커 허브는 ID)/리포지토리_이름:버전'의 형식을 띈다.
```groovy
zoozoo.com/dhkstn:13
```

#### 이미지에 태그를 부여하는 명령어
```java
docker tag 원래_이미지_이름 레지스트리_주소/리포지토리_이름:버전

docker tag apa000ex22 zoozoo.com/dhkstnaos:13
```

#### 이미지를 업로드하는 명령어
```java
docker push 레지스트리_주소/리포지토리_이름:버전

docker push zoozoo.com/dhkstnaos:13
```
